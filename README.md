# Data Interconverter

The Data Interconverter is a web-based utility designed for seamless conversion between various data modalities, all revolving around a central **Canonical Index** (a BigInt). It allows users to represent and transform data between:

![Data-Interconverter](screenshot.png)
[Data-Interconverter](https://data-interconverter.netlify.app/)

*   **Text:** Arbitrary text strings using a programmer-focused character set.
*   **Images:**
    *   Generate images from the Canonical Index.
    *   Convert uploaded images (arbitrary or system-generated) into a Canonical Index.
    *   System-generated PNGs embed metadata (dimensions, channels, bits per channel, significant pixel length) in their filenames for lossless re-import of the Canonical Index.
*   **Numerical Sequences:** Represent the Canonical Index as a sequence of 24-bit numerical values, and vice-versa.
*   **Raw Binary Sequence Files:** Import and export these numerical sequences as compact binary files (`.seqbin`).

This tool is particularly useful for exploring data representations, digital archaeology, or any scenario requiring a unified numerical representation for diverse data types.

## Features

*   **Canonical Index (BigInt):** The core of the application, allowing for arbitrary precision numerical representation of data.
*   **Text Conversion:**
    *   Convert text to Canonical Index using a comprehensive, programmer-focused character set.
    *   Convert Canonical Index back to text.
*   **Image Conversion:**
    *   **Index to Image:** Generates an image visualization from the current Canonical Index. Image dimensions are optimized to represent the data.
    *   **Image to Index:**
        *   **System PNGs:** Imports PNGs previously generated by this tool. Filename metadata (`width`, `height`, `channels`, `bitsPerChannel`, `significantLength`) is used to reconstruct the original Canonical Index losslessly.
        *   **Arbitrary Images:** Imports standard image formats (JPG, PNG, GIF, etc.). These are processed based on the current UI settings for channels and bits per channel to derive a Canonical Index.
    *   **Configurable Image Parameters:** Users can select the number of channels (Grayscale, RGB, RGBA) and bits per channel (1, 2, 4, 8) for interpreting the relationship between the Canonical Index and image pixel data.
    *   **Pixelated Rendering:** Images are rendered with `image-rendering: pixelated` for clear visibility of individual "super-pixels."
    *   **Smart Display Scaling:** The main image view scales to fit its container while maintaining aspect ratio.
*   **Numerical Sequence Conversion:**
    *   Convert Canonical Index to a comma-separated sequence of 24-bit unsigned integers.
    *   Convert a user-inputted sequence of 24-bit numbers back to a Canonical Index.
    *   Displays the canonical (minimal) length of the sequence for the current index.
*   **Raw Binary Sequence I/O:**
    *   **Export:** Save the current numerical sequence as a compact raw binary file (`.seqbin`), with metadata (number of elements, bit width) in the filename.
    *   **Import:** Load a `.seqbin` file to reconstruct the numerical sequence and update the Canonical Index.
*   **Responsive UI:**
    *   User-friendly interface with clear controls and feedback.
    *   Loading indicators for potentially long operations to prevent UI freezing (e.g., during large image processing).
    *   Error modals for clear communication of issues.
*   **Performance:**
    *   Debounced inputs to prevent excessive recalculations.
    *   Chunked processing for image pixel data conversion (`imageDataToPixelArrayChunked`) to improve UI responsiveness during large image uploads.

## How It Works

1.  **Canonical Index:** All data types are convertible to and from a single, non-negative arbitrary-precision integer (BigInt). This index serves as the universal intermediate representation.
2.  **Text:** Text is converted character by character using a predefined character set. Each character's position in the set contributes to the BigInt value, similar to a base conversion.
3.  **Images:**
    *   **Super-Pixels:** Image data is conceptualized as a sequence of "super-pixels." Each super-pixel's value is a BigInt derived from its channel data (e.g., R, G, B values) and the selected bits per channel (BPC). The more channels and higher BPC, the larger the numerical base for each super-pixel.
    *   **Index ↔ Super-Pixel Array:** The Canonical Index is converted to/from an array of these super-pixel BigInts.
    *   **Super-Pixel Array ↔ ImageData:** The array of super-pixel BigInts is then mapped to/from standard RGBA `ImageData` for display on a canvas.
    *   **Filename Metadata:** For system-generated PNGs, crucial parameters (`width`, `height`, `channels`, `bitsPerChannel`, and `significantLength`—the number of super-pixels that actually form the index before any rectangular padding) are encoded in the filename. This allows the tool to correctly re-interpret the image and reconstruct the exact original Canonical Index.
4.  **Numerical Sequence:** The Canonical Index is treated as a large number in base `2^24`. Each "digit" in this base becomes an element in the 24-bit numerical sequence.
5.  **Raw Binary:** The 24-bit sequence elements are written to/read from a file as 3-byte chunks.

## Getting Started

1.  Clone this repository or download the `data-interconverter.html` file.
2.  Open `data-interconverter.html` in a modern web browser (Chrome, Firefox, Edge, Safari recommended).

## Usage

*   **Canonical Index Input:** Directly type or paste a BigInt. Non-digits are ignored.
*   **Text Data Input:** Type or paste text. The corresponding Canonical Index will be generated.
*   **Image Upload:**
    *   Upload any image. If it's a PNG generated by this tool, its embedded filename metadata will be used for precise conversion.
    *   If it's an arbitrary image, the current "Channels" and "Bits/Channel" settings in the UI will be used to convert it to an Index. Large images may prompt for pre-downscaling.
*   **Image Parameters (Channels, Bits/Channel):** These settings control how the Canonical Index is visually interpreted as an image and how arbitrary uploaded images are processed. System-generated PNGs will override these settings with their own metadata upon import.
*   **Download Image as PNG:** Exports the current Canonical Index as a PNG image. The filename will include metadata for lossless re-import.
*   **Sequence Input:** Enter comma-separated 24-bit numbers to define a Canonical Index.
*   **Save/Load Sequence as Raw Binary:** Use these buttons to save the current sequence to a `.seqbin` file or load one. Filenames for loaded binary sequences should ideally contain `_N<length>_B24` metadata.

## Technical Details

*   **HTML, CSS, JavaScript:** Pure client-side application. No server-side components required.
*   **BigInt:** Natively supported in modern JavaScript for handling arbitrarily large integers.
*   **Canvas API:** Used for image rendering and pixel manipulation.
*   **File API (FileReader, Blob, ObjectURL):** Used for image uploads and file downloads (PNG, raw binary).
*   **Performance Optimizations:**
    *   Input debouncing.
    *   `requestAnimationFrame` for batching DOM updates.
    *   Chunked processing for `ImageData` to prevent UI freezes during intensive pixel operations.

## Future Considerations (Potential Enhancements)

*   **Web Workers for Image Processing:** For even greater performance with very large images, moving the core pixel processing logic (`imageDataToPixelArrayChunked`, `imagePixelsToIndex`) to a Web Worker using `OffscreenCanvas` would keep the main thread entirely free.
*   **More Sophisticated Image Dimension Optimization:** Explore algorithms that might produce more aesthetically pleasing or data-dense rectangular dimensions for `indexToImage`.
*   **Support for Other Numerical Sequence Bit Widths:** Allow user selection for sequence element bit width (e.g., 8-bit, 16-bit, 32-bit) for sequence I/O.
*   **Error Correction/Resilience for Binary Files:** Add checksums or more robust metadata handling for raw binary files.
*   **Direct Hex/Base64 Input for Canonical Index:** Allow input of the index in common large number formats.

## Contributing

Contributions, bug reports, and feature suggestions are welcome! Please feel free to open an issue or submit a pull request.

---

_Data Interconverter - Explore the numerical essence of your data._
